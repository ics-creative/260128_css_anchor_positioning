<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>タブUI（:target-current版）</title>

    <link rel="stylesheet" href="style.css" />

    <style>
      /* target-current 固有スタイル */
      .swipeTabs {
        overflow: hidden;
      }

      .swipeTabs .tabbar .row {
        scroll-target-group: auto;
      }

      .swipeTabs .tabbar .row::before {
        content: "";
        position: absolute;
        border-radius: 999px;
        background: #3223b3;
        pointer-events: none;
        z-index: 0;

        position-anchor: --current-tab;
        top: anchor(top);
        left: anchor(left);
        width: anchor-size(width);
        height: anchor-size(height);

        transition: top 0.3s ease, left 0.3s ease, width 0.3s ease, height 0.3s ease;
      }

      .swipeTabs .tabbar .tab:target-current {
        anchor-name: --current-tab;
        color: #fff;
      }

      .swipeTabs .slides {
        overflow-x: auto;
        overflow-y: hidden;
        scroll-snap-type: x mandatory;
        scroll-behavior: smooth;
        -webkit-overflow-scrolling: touch;
        scrollbar-width: none;
      }

      /* デフォルト（:target-currentがない場合）は最初のタブ */
      .row:not(:has(.tab:target-current)) .tab:first-child {
        anchor-name: --current-tab;
      }
    </style>
  </head>

  <body>
    <div id="app" v-cloak>
      <div class="demo">
        <div class="swipeTabs">
          <div class="tabbar">
            <div class="row" role="tablist">
              <a
                v-for="(tab, index) in tabs"
                :key="tab.id"
                class="tab"
                :href="`#${tab.panelId}`"
                role="tab"
                :id="tab.id"
                :aria-controls="tab.panelId"
                :aria-selected="activeTabIndex === index"
                >{{ tab.label }}</a
              >
            </div>
          </div>

          <div class="slides">
            <section
              v-for="(panel, index) in panels"
              :key="panel.id"
              class="panel"
              :id="panel.id"
              role="tabpanel"
              :aria-describedby="`tab-${index + 1}`"
            >
              <h2>{{ panel.title }}</h2>
              <p>{{ panel.description }}</p>
              <div class="photo-grid">
                <div
                  v-for="(photo, photoIndex) in panel.photos"
                  :key="photoIndex"
                  class="photo-item"
                >
                  <img :src="photo.src" alt="" loading="lazy" />
                </div>
              </div>
            </section>
          </div>
        </div>
      </div>
    </div>

    <script type="importmap">
      {
        "imports": {
          "vue": "https://unpkg.com/vue@3/dist/vue.esm-browser.prod.js"
        }
      }
    </script>
    <script type="module">
      import { createTabApp } from "./main.js";

      createTabApp().mount("#app");
    </script>
  </body>
</html>
